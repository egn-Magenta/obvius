<h1><% $title %></h1>

<table>
% foreach my $field (@fields) {
%    my $value=$vdoc->field($field->{name});
%    if (defined $value) {
<tr>
<td><% $field->{title} %>:</td>
<td>
<% exists($field->{display}) ? $field->{display}($value) : $value %><% (defined $field->{unit} ? ' ' . $field->{unit} : '') %>
</td>
</tr>
%    }
% }
</table>

<p>
% if (!defined($vdoc->Width) || !$vdoc->Width || !defined($vdoc->Height) || $vdoc->Height) {
  <img src="<% $linkuri %>" alt="Picture: <% $vdoc->field('short_title') %>" /><br />
%} else {
  <img width="<% $vdoc->Width %>" height="<% $vdoc->Height %>" src="<% $linkuri %>"
       alt="Picture: <% $vdoc->field('short_title') %>" /><br />
%}
</p>

%
% #####################
%
<%args>
$output
</%args>
%
<%init>
$obvius->get_version_fields($vdoc, [qw(title short_title width height size mimetype)]);
my $title = $vdoc->Title;

my $obvius_version=$output->param('_incoming_obvius_version');

my $linkuri=$prefix . $uri;
$linkuri =~ s/[\/]$//;
$linkuri .= "?obvius_version=$obvius_version" if (defined $obvius_version);
</%init>
%
<%once>
use Number::Bytes::Human qw(format_bytes);
my @fields=(
    { name=>'mimetype', title=>'MIME-type', },
    { name=>'width',    title=>'Bredde',    unit=>'pixels'},
    { name=>'height',   title=>'Hjde',     unit=>'pixels'},
    { name=>'size',     title=>'Strrelse', display=>
        sub {
            my ($size) = @_;
            return format_bytes($size, bs=>1024, suffixes=>'si_1000', precision=>2);
        }
    },
    { name=>'align',    title=>'Placering', },
);
</%once>
